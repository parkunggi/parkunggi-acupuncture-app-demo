<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>経穴検索デモ</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="Cache-Control" content="no-store">
<style>
  :root {
    --box-bg:#fff;
    --box-border:#d4dae0;
    --radius:8px;
    --right-col-width:420px; /* 必要なら調整 */
    --gap:12px;
  }
  * { box-sizing:border-box; }
  body {
    margin:0;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
    line-height:1.45;
    background:#f5f7fa;
    color:#222;
  }
  header {
    padding:6px 12px;
    background:#0d6efd;
    color:#fff;
  }
  header h1 {
    margin:0;
    font-size:1.05rem;
    font-weight:600;
    letter-spacing:.03em;
  }
  main { padding:12px 16px 48px; }

  /* 外枠 2カラム: 左コンテンツ / 右 結果 */
  #main-screen {
    display:grid;
    grid-template-columns: minmax(0,1fr) var(--right-col-width);
    gap:var(--gap);
    align-items:start;
  }

  /* 左内部 2グリッド (検索 / 症状) + 下段 治療 */
  .left-inner {
    display:grid;
    gap:var(--gap);
    grid-template-columns:1fr 1fr;
    grid-template-areas:
      "search symptoms"
      "treatment treatment";
    align-items:start;
  }
  .search-container       { grid-area:search; }
  .selection-container    { grid-area:symptoms; }
  .clinical-result        { grid-area:treatment; }

  .search-container,
  .selection-container,
  .clinical-result,
  .result-layout {
    background:var(--box-bg);
    border:1px solid var(--box-border);
    border-radius:var(--radius);
    padding:12px 14px 14px;
  }

  .search-container h2,
  .selection-container h2,
  .clinical-result h2,
  .result-layout h2 {
    margin:0 0 8px;
    font-size:.95rem;
    font-weight:600;
  }

  /* 右カラム: 経穴結果 */
  #inline-acupoint-result {
    position:sticky;
    top:10px;
    max-height:calc(100vh - 24px);
    overflow:auto;
    scrollbar-width:thin;
    display:flex;
    flex-direction:column;
    gap:10px;
  }

  /* 経穴詳細内部 */
  .info-container h3 {
    font-size:.7rem;
    margin:10px 0 3px;
    letter-spacing:.05em;
    color:#555;
  }
  .info-container p,
  .info-container ul {
    margin:0;
    font-size:.75rem;
    line-height:1.3;
    padding:0;
    list-style:disc inside;
  }
  .info-container ul li { margin:0 0 3px; }

  #acupoint-search-input {
    width:100%;
    padding:7px 9px;
    font-size:.9rem;
    border:1px solid #c3ccd4;
    border-radius:6px;
    background:#fff;
  }
  #acupoint-search-input:focus {
    outline:2px solid #0d6efd55;
    border-color:#0d6efd;
  }
  #search-btn {
    margin-top:8px;
    padding:6px 14px;
    font-size:.8rem;
    border:1px solid #0d6efd;
    background:#0d6efd;
    color:#fff;
    border-radius:20px;
    cursor:pointer;
  }
  #search-btn:hover { background:#0b5ed7; }

  #acupoint-suggestion-list {
    max-height:210px;
    overflow:auto;
    margin:6px 0 0;
    padding:0;
    list-style:none;
    border:1px solid #c3ccd4;
    border-radius:6px;
    background:#fff;
  }
  #acupoint-suggestion-list.hidden { display:none; }
  #acupoint-suggestion-list li {
    padding:6px 8px;
    font-size:.78rem;
    cursor:pointer;
    border-bottom:1px solid #eef1f4;
  }
  #acupoint-suggestion-list li:last-child { border-bottom:none; }
  #acupoint-suggestion-list li:hover,
  #acupoint-suggestion-list li:focus {
    background:#0d6efd;
    color:#fff;
  }

  .clinical-result {
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .clinical-result.empty::before {
    content:"病証を選択すると治療方針が表示されます";
    font-size:.75rem;
    color:#777;
  }

  .treat-line { margin:0 0 8px; }
  .treat-main { margin:0 0 2px; font-size:.72rem; line-height:1.35; }
  .treat-comment { margin:0 0 4px; font-size:.65rem; color:#555; }
  .treat-main a { font-size:.72rem; text-decoration:none; border-bottom:1px solid #aaa; color:#004b8d; }
  .treat-main a:hover { color:#d40000; border-bottom-color:#d40000; }
  .treat-main a.acu-important { color:#c40000; font-weight:700; border-bottom-color:#c40000; }
  .treat-main a.acu-important:hover { color:#ff2a2a; border-bottom-color:#ff2a2a; }

  .acu-pattern-link { font-size:.7rem; }

  .hidden { display:none !important; }

  #status-float {
    position:fixed;
    right:10px;
    bottom:10px;
    background:rgba(0,0,0,.55);
    color:#fff;
    font-size:10px;
    padding:7px 10px 6px;
    border-radius:8px;
    backdrop-filter:blur(4px);
    z-index:999;
    line-height:1.2;
    max-width:230px;
  }
  #status-float span {
    display:block;
    margin:0 0 3px;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  #status-float span:last-child { margin-bottom:0; }

  .match-badge { font-size:.55rem; background:#eee; padding:2px 4px; border-radius:3px; margin-left:4px; }

  /* モバイル 1カラム: 順序 = 検索 → 症状 → 治療 → 結果 */
  @media (max-width:860px) {
    #main-screen {
      grid-template-columns:1fr;
    }
    .left-inner {
      grid-template-columns:1fr;
      grid-template-areas:
        "search"
        "symptoms"
        "treatment";
    }
    #inline-acupoint-result {
      position:static;
      max-height:none;
      order:4;
      margin-top:var(--gap);
    }
  }
</style>
</head>
<body>
<header>
  <h1>経穴検索デモ</h1>
</header>
<main>
  <section id="main-screen">

    <!-- 左カラム -->
    <div class="left-inner">
      <!-- 検索 -->
      <div class="search-container">
        <h2>経穴検索</h2>
        <input
          id="acupoint-search-input"
          type="text"
          placeholder="経穴名（漢字 / ひらがな）または筋肉名"
          autocomplete="off"
          aria-autocomplete="list"
          aria-haspopup="listbox"
          aria-expanded="false"
          aria-owns="acupoint-suggestion-list">
        <div class="suggestion-wrapper">
          <ul id="acupoint-suggestion-list" class="hidden" role="listbox"></ul>
        </div>
        <button id="search-btn" type="button">検索</button>
      </div>

      <!-- 症状・病証 -->
      <div class="selection-container">
        <h2>症状・病証</h2>
        <div style="margin-bottom:6px;">
          <label for="clinical-category-select" style="display:block;font-size:.7rem;margin:0 0 3px;">カテゴリ</label>
          <select id="clinical-category-select">
            <option value="">--</option>
          </select>
        </div>
        <div>
          <label for="clinical-pattern-select" style="display:block;font-size:.7rem;margin:0 0 3px;">病証</label>
          <select id="clinical-pattern-select" disabled>
            <option value="">--</option>
          </select>
        </div>
      </div>

      <!-- 治療方針（左下） -->
      <div id="clinical-treatment-result" class="clinical-result empty hidden" aria-live="polite">
        <h2 id="clinical-selected-title" style="margin-top:0;">治療方針</h2>
        <div id="clinical-treatment-groups"></div>
      </div>
    </div>

    <!-- 右カラム: 経穴結果 -->
    <div id="inline-acupoint-result" class="result-layout hidden" aria-live="polite">
      <div class="info-container">
        <h2 id="result-name">（経穴名）</h2>
        <h3>経絡</h3><p id="result-meridian">（経絡未登録）</p>
        <h3>部位</h3><p id="result-region">（部位未登録）</p>
        <h3>要穴</h3><p id="result-important">-</p>
        <h3>筋肉</h3><p id="result-muscle">（筋肉未登録）</p>
        <h3>病証名</h3>
        <ul id="related-symptoms"><li>-</li></ul>
      </div>
    </div>

  </section>

  <!-- ステータス -->
  <div id="status-float">
    <span id="data-load-status">CSV 読み込み中...</span>
    <span id="clinical-load-status">臨床CSV 読み込み中...</span>
  </div>
</main>

<!-- 既存 JS （バージョン更新でキャッシュ回避） -->
<script src="readings.js?v=20250918-14"></script>
<script src="muscle-map.js?v=20250918-14"></script>
<script src="app.js?v=20250918-31"></script>
</body>
</html>
