<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>経穴検索デモ</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <meta http-equiv="Cache-Control" content="no-store">
  <style>
    /* 画面最小化調整用 追加CSS */
    body{
      font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
      line-height:1.35;
    }
    header{padding:4px 10px;}
    header h1{font-size:1.05rem;margin:0;}
    main{padding:4px 8px;}
    #main-screen{
      display:grid;
      grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
      gap:10px;
      align-items:start;
    }
    .search-container,.selection-container,.clinical-result,.result-layout{
      border:1px solid #ccc;
      border-radius:6px;
      padding:8px 10px;
      background:#fff;
    }
    .search-container h2,
    .selection-container h2{
      font-size:.95rem;
      margin:0 0 4px;
    }
    .selection-container p,
    .search-container p{margin:.25rem 0;}
    #acupoint-search-input{
      width:100%;
      padding:6px 8px;
      font-size:.9rem;
      box-sizing:border-box;
    }
    #search-btn{
      margin-top:6px;
      padding:4px 10px;
      font-size:.8rem;
    }
    #acupoint-suggestion-list{
      max-height:190px;
    }
    .clinical-result h2{
      font-size:.9rem;
      margin:0 0 6px;
    }
    .result-layout{
      display:flex;
      gap:8px;
      flex-direction:column;
    }
    .result-layout h2{
      font-size:1rem;
      margin:0 0 6px;
    }
    .info-container h3{
      font-size:.75rem;
      margin:8px 0 2px;
      letter-spacing:.03em;
    }
    .info-container p, .info-container ul{
      margin:0;
      font-size:.75rem;
      line-height:1.25;
      padding:0;
      list-style:disc inside;
    }
    .info-container ul li{margin:0 0 2px;padding:0;}
    .treat-line{margin:0 0 6px;}
    .treat-main{
      margin:0 0 2px;
      font-size:.75rem;
      line-height:1.35;
    }
    .treat-comment{
      margin:0 0 2px;
      font-size:.65rem;
    }
    .pattern-name-highlight{
      color:#0066cc;
      font-weight:600;
    }
    .treat-main a{
      font-size:.75rem;
    }
    .acu-pattern-link{font-size:.72rem;}
    #status-float{
      position:fixed;
      right:8px;
      bottom:8px;
      background:rgba(0,0,0,.55);
      color:#fff;
      font-size:10px;
      line-height:1.2;
      padding:6px 8px 5px;
      border-radius:6px;
      z-index:999;
      backdrop-filter:blur(4px);
      max-width:200px;
    }
    #status-float span{display:block;margin:0 0 2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    #status-float span:last-child{margin-bottom:0;}
    .match-badge{font-size:.55rem;}
    .acu-important-flag{color:#c40000;font-weight:700;}
    .treat-point-link{white-space:nowrap;}
    .treat-main a.acu-important{color:#c40000;border-bottom-color:#c40000;font-weight:700;}
    .treat-main a.acu-important:hover{color:#ff2a2a;border-bottom-color:#ff2a2a;}
    /* 小さい画面で縦並び */
    @media (max-width:720px){
      #main-screen{grid-template-columns:1fr;}
      .result-layout{order:3;}
      .clinical-result{order:4;}
    }
  </style>
</head>
<body>
<header>
  <h1>経穴検索デモ</h1>
</header>

<main>
  <section id="main-screen">

    <!-- 経穴検索 -->
    <div class="search-container">
      <h2>経穴検索</h2>
      <input
        type="text"
        id="acupoint-search-input"
        placeholder="経穴名（漢字 / ひらがな）または筋肉名（漢字）を入力してください（1文字以上で候補表示）"
        autocomplete="off"
        aria-autocomplete="list"
        aria-haspopup="listbox"
        aria-expanded="false"
        aria-owns="acupoint-suggestion-list"
      >
      <div class="suggestion-wrapper">
        <ul id="acupoint-suggestion-list" class="hidden" role="listbox"></ul>
      </div>
      <button id="search-btn" type="button">検索</button>
    </div>

    <!-- 症状・病証 選択 -->
    <div class="selection-container">
      <h2>症状・病証</h2>
      <div class="clinical-select-group" style="margin-bottom:4px;">
        <label for="clinical-category-select" style="margin-bottom:2px;">カテゴリ</label>
        <select id="clinical-category-select">
          <option value="">--</option>
        </select>
      </div>
      <div class="clinical-select-group" style="margin-bottom:2px;">
        <label for="clinical-pattern-select" style="margin-bottom:2px;">病証</label>
        <select id="clinical-pattern-select" disabled>
          <option value="">--</option>
        </select>
      </div>
    </div>

    <!-- 経穴詳細 -->
    <div id="inline-acupoint-result" class="result-layout hidden" aria-live="polite">
      <div class="info-container">
        <h2 id="result-name">（経穴名）</h2>

        <h3>経絡</h3>
        <p id="result-meridian">（経絡未登録）</p>

        <h3>部位</h3>
        <p id="result-region">（部位未登録）</p>

        <h3>要穴</h3>
        <p id="result-important">-</p>

        <h3>筋肉</h3>
        <p id="result-muscle">（筋肉未登録）</p>

        <h3>病証名</h3>
        <ul id="related-symptoms">
          <li>-</li>
        </ul>
      </div>
    </div>

    <!-- 治療方針 -->
    <div id="clinical-treatment-result" class="clinical-result hidden" aria-live="polite">
      <h2 id="clinical-selected-title" style="margin-top:0;">（治療方針）</h2>
      <div id="clinical-treatment-groups"></div>
    </div>

  </section>
</main>

<!-- 浮動ステータス -->
<div id="status-float">
  <span id="data-load-status">CSV 読み込み中...</span>
  <span id="clinical-load-status">臨床CSV 読み込み中...</span>
</div>

<script src="readings.js?v=20250918-14"></script>
<script src="muscle-map.js?v=20250918-14"></script>
<script src="app.js?v=20250918-27"></script>
</body>
</html>
